(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{463:function(t,s,a){"use strict";a.r(s);var e=a(2),i=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"algorithm-for-recovery-and-isolation-exploiting-semantics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#algorithm-for-recovery-and-isolation-exploiting-semantics"}},[t._v("#")]),t._v(" Algorithm for Recovery and Isolation Exploiting Semantics")]),t._v(" "),s("h2",{attrs:{id:"_1-main-ideas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-main-ideas"}},[t._v("#")]),t._v(" 1. Main Ideas")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Write-Ahead Logging:")]),t._v(" "),s("ul",[s("li",[t._v("Any change is recorded in log on stable storage before the\ndatabase change is written to disk.")]),t._v(" "),s("li",[t._v("Must use STEAL + NO-FORCE buffer pool policies.")])])]),t._v(" "),s("li",[s("p",[t._v("Repeating History During Redo:")]),t._v(" "),s("ul",[s("li",[t._v("On DBMS restart, retrace actions and restore database to\nexact state before crash.")])])]),t._v(" "),s("li",[s("p",[t._v("Logging Changes During Undo:")]),t._v(" "),s("ul",[s("li",[t._v("Record undo actions to log to ensure action is not\nrepeated in the event of repeated failures.")])])])]),t._v(" "),s("h2",{attrs:{id:"_2-log-sequence-number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-log-sequence-number"}},[t._v("#")]),t._v(" 2. Log Sequence Number")]),t._v(" "),s("p",[t._v("We need to extend our log record format from last class to include additional info."),s("br"),t._v("\nEvery log record now includes a globally unique\n"),s("em",[s("strong",[t._v("log sequence number")])]),t._v(" ("),s("strong",[t._v("LSN")]),t._v(").")]),t._v(" "),s("ul",[s("li",[t._v("LSNs represent the physical order that txns make changes\nto the database.")])]),t._v(" "),s("p",[t._v("Various components in the system keep track of\nLSNs that pertain to them…")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Location")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("Definition")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("flushedLSN")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Memory")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Last LSN in log on disk")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("pageLSN")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("a")]),s("mi",[t._v("g")]),s("msub",[s("mi",[t._v("e")]),s("mi",[t._v("x")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("page_x")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("x")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Newest update to "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("a")]),s("mi",[t._v("g")]),s("msub",[s("mi",[t._v("e")]),s("mi",[t._v("x")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("page_x")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("x")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("recLSN")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("a")]),s("mi",[t._v("g")]),s("msub",[s("mi",[t._v("e")]),s("mi",[t._v("x")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("page_x")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("x")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Oldest update to "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("a")]),s("mi",[t._v("g")]),s("msub",[s("mi",[t._v("e")]),s("mi",[t._v("x")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("page_x")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("x")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(" since it was last flushed")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("lastLSN")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("T")]),s("mi",[t._v("i")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("T_i")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.13889em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Latest record of txn "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("T")]),s("mi",[t._v("i")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("T_i")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.13889em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("i")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("MasterRecord")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Disk")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("LSN of latest checkpoint")])])])]),t._v(" "),s("p",[t._v("Each data page contains a "),s("em",[s("strong",[t._v("pageLSN")])]),t._v(" (the LSN of the most recent update to that page)."),s("br"),t._v("\nSystem keeps track of "),s("em",[s("strong",[t._v("flushedLSN")])]),t._v(" (the max LSN flushed so far).\nBefore the DBMS can write page x to disk, it must flush the log at least to the point where "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("a")]),s("mi",[t._v("g")]),s("mi",[t._v("e")]),s("mi",[t._v("L")]),s("mi",[t._v("S")]),s("msub",[s("mi",[t._v("N")]),s("mi",[t._v("x")])],1),s("mo",[t._v("≤")]),s("mi",[t._v("f")]),s("mi",[t._v("u")]),s("mi",[t._v("s")]),s("mi",[t._v("h")]),s("mi",[t._v("e")]),s("mi",[t._v("d")]),s("mi",[t._v("L")]),s("mi",[t._v("S")]),s("mi",[t._v("N")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("pageLSN_x\\le fushedLSN")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"mord mathit"},[t._v("L")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10903em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("x")])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),s("span",{staticClass:"mrel"},[t._v("≤")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),s("span",{staticClass:"mord mathit"},[t._v("u")]),s("span",{staticClass:"mord mathit"},[t._v("s")]),s("span",{staticClass:"mord mathit"},[t._v("h")]),s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"mord mathit"},[t._v("d")]),s("span",{staticClass:"mord mathit"},[t._v("L")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),t._v(".")])])}),[],!1,null,null,null);s.default=i.exports}}]);